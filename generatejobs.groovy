
def folderName = 'generated-jobs'
def gitRepo = 'https://github.com/northbear/jenkins-generated-jobs.git'
def githubRepo = 'northbear/jenkins-generated-jobs'
def dockerRegistry='northbear'

folder('generated-jobs') {
    displayName('Generated Jobs')
    description('Folder for jobs generated by another jobs')
}    

pipelineJob("$folderName/build-flask-app") {
    environmentVariables {
        env('DOCKER_REGISTRY', dockerRegistry)
    }
    definition {
        cpsScm {
            lightweight()
            scm {
                github(githubRepo, 'master')
            }
            scriptPath('docker-flask-builder/Jenkinsfile')
        }
    }
}

pipelineJob("$folderName/build-nginx-proxy") {
    environmentVariables {
        env('DOCKER_REGISTRY', dockerRegistry)
    }
    definition {
        cpsScm {
            lightweight()
            scm {
                github(githubRepo, 'master')
            }
            scriptPath('docker-nginx-builder/Jenkinsfile')
        }
    }
}

pipelineJob("$folderName/run-application") {
    environmentVariables {
        env('DOCKER_REGISTRY', dockerRegistry)
    }
    definition {
        cpsScm {
            lightweight()
            scm {
                github(githubRepo, 'master')
            }
            scriptPath('run-system/Jenkinsfile')
        }
    }
}

job('$folderName/test-variables') {
    environmentVariables {
        env('DOCKER_REGISTRY', dockerRegistry)
    }
    steps {
        shell('echo ${DOCKER_REGISTRY}')
    }
}
